<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Write - Orion Reed</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico?v=4" />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=4" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Recursive:slnt,wght,CASL,CRSV,MONO@-15..0,300..1000,0..1,0..1,0..1&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/css/reset.css" />
    <link rel="stylesheet" href="/css/style.css" />

    <!-- Prevent flash of unstyled content by applying theme immediately -->
    <script>
      (function () {
        const savedTheme = localStorage.getItem("theme");
        const prefersDark = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;
        const theme = savedTheme || (prefersDark ? "dark" : "light");
        document.documentElement.setAttribute("data-theme", theme);
      })();
    </script>

    <!-- KaTeX for LaTeX rendering -->
    <link rel="stylesheet" href="/node_modules/katex/dist/katex.min.css" />

    <style>
      body {
        margin: 0;
        height: 100vh;
        display: flex;
        flex-direction: column;
      }

      .toolbar {
        background: #f5f5f5;
        border-bottom: 1px solid #ddd;
        padding: 0.25rem 1rem;
        display: flex;
        gap: 0.75rem;
        align-items: center;
        font-family: "Recursive";
        font-variation-settings: "CASL" 1;
      }

      .toolbar button {
        padding: 0.25rem 0.75rem;
        border: 1px solid #ccc;
        background: white;
        border-radius: 4px;
        cursor: pointer;
        font-family: "Recursive";
        font-size: 0.9rem;
      }

      .toolbar button:hover {
        background: #f0f0f0;
      }

      .toolbar input {
        padding: 0.25rem 0.5rem;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-family: "Recursive";
        font-size: 0.9rem;
        flex: 1;
        max-width: 250px;
      }

      .editor-container {
        flex: 1;
        display: flex;
        height: calc(100vh - 40px);
      }

      .editor-pane {
        flex: 1;
        display: flex;
        flex-direction: column;
        border-right: 1px solid #ddd;
      }

      .preview-pane {
        flex: 1;
        display: flex;
        flex-direction: column;
      }

      .editor-textarea {
        flex: 1;
        border: none;
        padding: 1rem;
        font-family: "Recursive", monospace;
        font-size: 14px;
        line-height: 1.5;
        resize: none;
        outline: none;
        background: #fafafa;
      }

      .preview-content {
        flex: 1;
        overflow-y: auto;
        background: white;
      }

      @media (max-width: 768px) {
        .editor-container {
          flex-direction: column;
        }

        .editor-pane {
          border-right: none;
          border-bottom: 1px solid #ddd;
        }

        .toolbar {
          flex-wrap: wrap;
          gap: 0.5rem;
        }

        .toolbar input {
          min-width: 200px;
        }
      }
    </style>
  </head>
  <body>
    <dark-mode-toggle></dark-mode-toggle>
    <div class="toolbar">
      <a href="/" style="text-decoration: none; font-weight: 600"
        >‚Üê Orion Reed</a
      >
      <input type="text" id="filename" placeholder="post-title" />
      <button id="save-btn">Save</button>
      <button id="load-btn">Load</button>
      <button id="download-btn">Download</button>
    </div>

    <div class="editor-container">
      <div class="editor-pane">
        <textarea
          id="editor"
          class="editor-textarea"
          placeholder="# Start writing...

Write your markdown here. LaTeX math is supported with $inline$ and $$display$$ syntax.

Example:
- **Bold text**
- *Italic text*
- `code`
- $f(x) = x^2$
- $$E = mc^2$$

"
        ></textarea>
      </div>

      <div class="preview-pane">
        <div class="preview-content">
          <main id="preview">
            <p><em>Preview will appear here as you type...</em></p>
          </main>
        </div>
      </div>
    </div>

    <script type="module" src="/src/editor.ts"></script>
    <script src="/css/dark-mode-toggle.js"></script>
  </body>
</html>
